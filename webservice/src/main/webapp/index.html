<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link href="main.css" type="text/css" rel="stylesheet">
        <!--<script type="text/javascript" src="websocket.js"></script>-->
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <title>IoT System</title>
    </head>
    <body>
        <div class="row">
            <div class="col-12" style="text-align: center; height: 110px">
                <h1>IoT System Dashboard</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <!-- Dht11 sensor -->
                <canvas id="temperature" height="200"></canvas>
            </div>
            <div class="col-3">
                <!-- Dallas temperature sensor -->
                <canvas id="humidity" height="200"></canvas>
            </div>
            <div class="col-3">
                <!-- Radiation sensor -->
                <canvas id="radiation" height="200"></canvas>
            </div>
            <div class="col-3">
                <!-- Light sensor -->
                <canvas id="light" height="200"></canvas>
            </div>
        </div>
        <script>
            var tempCtx = document.getElementById('temperature').getContext('2d');
            var humCtx = document.getElementById('humidity').getContext('2d');
            var radCtx = document.getElementById('radiation').getContext('2d');
            var lightCtx = document.getElementById('light').getContext('2d');
            setInterval(update, 1000);

            function update() 
            {
                var d = new Date();
                var t = d.toLocaleTimeString();
              
                var tempChart = new Chart(tempCtx, 
                {
                    // The type of chart we want to create
                    type: 'bar',

                    // The data for our dataset
                    data: 
                    {
                        labels: [t],
                        datasets: 
                        [{
                            label: 'Temperature',
                            backgroundColor: '#173F5F',
                            borderColor: '#FFFFFF',
                            data: [Math.random()]
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        //animation: true,
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Temperature'
                        }
                    }
                });
                

                var humChart = new Chart(humCtx, 
                {
                    // The type of chart we want to create
                    type: 'bar',

                    // The data for our dataset
                    data: 
                    {
                        labels: [t],
                        datasets: 
                        [{
                            label: 'Humidity',
                            backgroundColor: '#F6D55C',
                            borderColor: '#FFFFFF',
                            data: [Math.random()]
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Humidity'
                        }
                    }
                });
                
                var radChart = new Chart(radCtx, 
                {
                    // The type of chart we want to create
                    type: 'bar',

                    // The data for our dataset
                    data: 
                    {
                        labels: [t],
                        datasets: 
                        [{
                            label: 'Radiation',
                            backgroundColor: '#ED553B',
                            borderColor: '#FFFFFF',
                            data: [Math.random()]
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Radiation'
                        }
                    }
                });                
                
                var lightChart = new Chart(lightCtx, 
                {
                    // The type of chart we want to create
                    type: 'bar',

                    // The data for our dataset
                    data: 
                    {
                        labels: [t],
                        datasets: 
                        [{
                            label: 'Light',
                            backgroundColor: '#3CAEA3',
                            borderColor: '#FFFFFF',
                            data: [Math.random()]
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Light'
                        }
                    }
                });                
                
                document.getElementById("temperature").innerHTML = tempChart;
                document.getElementById("humidity").innerHTML = humChart;
                document.getElementById("radiation").innerHTML = radChart;
                document.getElementById("light").innerHTML = lightChart;
            }
        </script>
    </body>
</html>
