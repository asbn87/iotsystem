<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link href="main.css" type="text/css" rel="stylesheet">
        <!--<script type="text/javascript" src="websocket.js"></script>-->
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
        <title>IoT System</title>
    </head>
    <body>
        <div class="main">
            <div class="row" style="height: 30%; margin: 0; padding: 0; border-bottom: 1px solid #FFF">
                <div class="flex-container">

                    <!-- Whitespace -->
                    <div class="col-1 flex-col" style="background-color: #1C1F1F; padding: 10px 0; text-align: center; color: white;">
                        <h4 id="realtime-title" style="padding: 10px 0; margin: 0">REALTIME:</h4>
                    </div>

                    <!-- Dht11 sensor temperature -->
                    <div class="col-2 flex-col">
                        <div style="padding: 10px 0; text-align: center; color: white;">
                            <span id="dht-temperature-label"><b>Temperature</b></span>
                                <br />
                            <span id="dht-temperature-value">20°C</span>
                        </div>
                    </div>

                    <!-- Dht11 sensor humidity -->
                    <div class="col-2 flex-col">
                        <div style="padding: 10px 0; text-align: center; color: white;">
                            <span id="dht-humidity-label"><b>Humidity</b></span>
                                <br />
                            <span id="dht-humidity-value">23%</span>
                        </div>
                    </div>

                    <!-- Dallas sensor temperature -->
                    <div class="col-2 flex-col">
                        <div style="padding: 10px 0; text-align: center; color: white;">
                            <span id="dallas-temperature-label"><b>Water Temperature</b></span>
                                <br />
                            <span id="dallas-temperature-value">36°C</span>
                        </div>
                    </div>

                    <!-- Radiation sensor -->
                    <div class="col-2 flex-col">
                        <div style="padding: 10px 0; text-align: center; color: white;">
                            <span id="radiation-label"><b>Radiation</b></span>
                                <br />
                            <span id="radiation-value">0.1 µSv</span>
                        </div>
                    </div>

                    <!-- Light sensor -->
                    <div class="col-2 flex-col">
                        <div style="padding: 10px 0; text-align: center; color: white;">
                            <span id="light-label"><b>Light</b></span>
                                <br />
                            <span id="light-value">300 lx</span>
                        </div>
                    </div>

                    <!-- Whitespace -->
                    <div class="col-1 flex-col" style="background-color: #1C1F1F; padding: 10px 0; text-align: center; color: white;">
                        <span id="update-label" style="padding: 10px 0;"><b>Updated:</b></span>
                            <br />
                        <span id="update-value">HH:mm:ss</span>
                    </div>

                </div>
            </div>

            <div class="row" style="margin: 0; padding: 0;">
                <div class="flex-container">

                    <div class="col-4 flex-col">
                        <canvas id="dht-temperature"></canvas>
                    </div>

                    <div class="col-4 flex-col">
                        <canvas id="dht-humidity"></canvas>
                    </div>

                    <div class="col-4 flex-col">
                        <canvas id="dallas-temperature"></canvas>
                    </div>

                </div>
            </div>

            <div class="row" style="height: 40%; margin: 0; padding: 0;">
                <div class="flex-container">

                    <div class="col-6 flex-col">
                        <canvas id="radiation"></canvas>
                    </div>

                    <div class="col-6 flex-col">
                        <canvas id="light"></canvas>
                    </div>

                </div>
            </div>
        </div>
        <script>
            var dhtTempCtx = document.getElementById('dht-temperature').getContext('2d');
            var dhtHumCtx = document.getElementById('dht-humidity').getContext('2d');
            var dallasTempCtx = document.getElementById('dallas-temperature').getContext('2d');
            var radCtx = document.getElementById('radiation').getContext('2d');
            var lightCtx = document.getElementById('light').getContext('2d');
            
            var minArray = [];
            var min = 1;

            while(min <= 60) {
                minArray[min] = min;
                min++;
            }
            setInterval(update, 1000);
            
            var dhtTempDataColor = '#50EFDA';
            var dhtHumDataColor = '#692D8D';
            var dallasTempDataColor = '#D564AB';         
            var radDataColor = '#FDB592';
            var lightDataColor = '#FEE29E';

            function update() 
            {
                var dataArray = [];
                var data = 1;
            
                while(data <= 60) {
                    dataArray[data] = Math.random();
                    data++;
                }
                var d = new Date();
                var t = d.toLocaleTimeString();

                var dhtTempChart = new Chart(dhtTempCtx,
                {
                    // The type of chart we want to create
                    type: 'line',

                    // The data for our dataset
                    data: 
                    {
                        labels: minArray,
                        datasets: 
                        [{
                            data: dataArray,
                            type: 'line',
                            pointRadius: 0,
                            fill: true,
                            lineTension: 0,
                            borderWidth: 2,
                            backgroundColor: dhtTempDataColor,
                            borderColor: dhtTempDataColor,
                            pointBorderColor: dhtTempDataColor,
                            pointBackgroundColor: dhtTempDataColor,
                            pointHoverBackgroundColor: dhtTempDataColor,
                            pointHoverBorderColor: dhtTempDataColor
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        animation: false,
                        scales:
                        {
                            yAxes: [{
                                gridLines: {
                                  display: false,
                                  color: '#FFF'
                                },
                                ticks: {
                                    beginAtZero: true,
                                    fontColor: '#FFF'
                                }
                            }],
                          xAxes: [{
                                ticks: {
                                    fontColor: '#FFF'
                                }
                            }]
                        },
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Temperature( °C )',
                            fontColor: '#FFF'
                        }
                    }
                });
                

                var dhtHumChart = new Chart(dhtHumCtx, 
                {
                    // The type of chart we want to create
                    type: 'line',

                    // The data for our dataset
                    data: 
                    {
                        labels: minArray,
                        datasets: 
                        [{
                            data: dataArray,
                            type: 'line',
                            pointRadius: 0,
                            fill: true,
                            lineTension: 0,
                            borderWidth: 2,
                            backgroundColor: dhtHumDataColor,
                            borderColor: dhtHumDataColor,
                            pointBorderColor: dhtHumDataColor,
                            pointBackgroundColor: dhtHumDataColor,
                            pointHoverBackgroundColor: dhtHumDataColor,
                            pointHoverBorderColor: dhtHumDataColor
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        animation: false,
                        scales:
                        {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true,
                                    fontColor: '#FFF'
                                }
                            }],
                          xAxes: [{
                                ticks: {
                                    fontColor: '#FFF'
                                }
                            }]
                        },
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Humidity( % )',
                            fontColor: '#FFF'
                        }
                    }
                });
                
                var dallasTempChart = new Chart(dallasTempCtx, 
                {
                    // The type of chart we want to create
                    type: 'line',

                    // The data for our dataset
                    data: 
                    {
                        labels: minArray,
                        datasets: 
                        [{
                            data: dataArray,
                            fontColor: '#FFF',
                            type: 'line',
                            pointRadius: 0,
                            fill: true,
                            lineTension: 0,
                            borderWidth: 2,
                            backgroundColor: dallasTempDataColor,
                            borderColor: dallasTempDataColor,
                            pointBorderColor: dallasTempDataColor,
                            pointBackgroundColor: dallasTempDataColor,
                            pointHoverBackgroundColor: dallasTempDataColor,
                            pointHoverBorderColor: dallasTempDataColor
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        animation: false,
                        scales:
                        {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true,
                                    fontColor: '#FFF'
                                }
                            }],
                          xAxes: [{
                                ticks: {
                                    fontColor: '#FFF'
                                }
                            }]
                        },
                        legend: 
                        {   
                            display: false
                        },
                        title: 
                        {
                            display: true,
                            text: 'Water Temperature( °C )',
                            fontColor: '#FFF'
                        }
                    }
                });
                
                var radChart = new Chart(radCtx, 
                {
                    // The type of chart we want to create
                    type: 'line',

                    // The data for our dataset
                    data: 
                    {
                        labels: minArray,
                        datasets: 
                        [{
                            data: dataArray,
                            type: 'line',
                            pointRadius: 0,
                            fill: true,
                            lineTension: 0,
                            borderWidth: 2,
                            backgroundColor: radDataColor,
                            borderColor: radDataColor,
                            pointBorderColor: radDataColor,
                            pointBackgroundColor: radDataColor,
                            pointHoverBackgroundColor: radDataColor,
                            pointHoverBorderColor: radDataColor
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        animation: false,
                        scales:
                        {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true,
                                    fontColor: '#FFF'
                                }
                            }],
                          xAxes: [{
                                ticks: {
                                    fontColor: '#FFF'
                                }
                            }]
                        },
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Radiation( µSv/h )',
                            fontColor: '#FFF'
                        }
                    }
                });                
                
                var lightChart = new Chart(lightCtx, 
                {
                    // The type of chart we want to create
                    type: 'line',

                    // The data for our dataset
                    data: 
                    {
                        labels: minArray,
                        datasets: 
                        [{
                            backgroundColor: '#FEE29E',
                            borderColor: '#FEE29E',
                            data: dataArray,
                            type: 'line',
                            pointRadius: 0,
                            fill: true,
                            lineTension: 0,
                            borderWidth: 2,
                            backgroundColor: lightDataColor,
                            borderColor: lightDataColor,
                            pointBorderColor: lightDataColor,
                            pointBackgroundColor: lightDataColor,
                            pointHoverBackgroundColor: lightDataColor,
                            pointHoverBorderColor: lightDataColor
                        }]
                    },

                    // Configuration options go here
                    options: 
                    {
                        animation: false,
                        scales:
                        {
                            yAxes: [{
                                ticks: {
                                    beginAtZero: true,
                                    fontColor: '#FFF'
                                }
                            }],
                          xAxes: [{
                                ticks: {
                                    fontColor: '#FFF'
                                }
                            }]
                        },
                        legend: 
                        { 
                            display: false 
                        },
                        title: 
                        {
                            display: true,
                            text: 'Light( lx )',
                            fontColor: '#FFF'
                        }
                    }
                });                
                
                document.getElementById("dht-temperature").innerHTML = dhtTempChart;
                document.getElementById("dht-humidity").innerHTML = dhtHumChart;
                document.getElementById("dallas-temperature").innerHTML = dallasTempChart;
                document.getElementById("radiation").innerHTML = radChart;
                document.getElementById("light").innerHTML = lightChart;
            }
        </script>
    </body>
</html>
